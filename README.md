# DeepScan

一个 AI 对话框项目（当前为 Next.js 实现），目标演进为**常见的纯前端 AI Chat 应用形态**：本地会话管理、模型切换、主题切换、代码渲染与可扩展插件能力。

## 当前状态（as-is）

- 已有对话体验：发送消息、流式输出、消息渲染、代码高亮复制。
- 已有会话管理：侧边栏会话列表、搜索、置顶、重命名、删除。
- 已有会话分组：按“置顶 / 今天 / 近 7 天 / 近 30 天 / 更早”分段浏览历史。
- 已有会话迁移：支持会话 JSON 导出/导入（本地备份与恢复）。
- 已有体验增强：亮暗主题、移动端适配、侧边栏折叠。
- 已有消息操作：代码块复制 + 消息全文复制。
- 当前仅保留模型流式聊天接口（`/api/chat`）；会话管理已前端本地化。

## 目标状态（to-be：纯前端）

将项目收敛为纯前端形态（不依赖项目自建后端）：

- 会话、设置、偏好全部在浏览器本地存储（`localStorage` / `IndexedDB`）。
- 模型调用通过前端 Provider 适配层（可选“用户自带 Key”模式）。
- 页面层与状态层解耦，支持未来接入多模型、多插件、多工作区。
- 保持“开箱即用 + 可二次开发”的工程结构。

## 纯前端项目边界

- 本项目默认不提供后端持久化和账号云同步。
- 若使用第三方模型 API，建议采用“用户粘贴 Key，仅本地保存”策略。
- 生产场景如需安全代理、审计、限流，建议单独部署网关服务（不在本阶段范围）。

## 新开发计划（按常见 AI 对话框项目）

### Phase 1：前端架构收敛（MVP 基座）

目标：形成纯前端可运行闭环。

- 移除或降级 `app/api/*` 依赖，建立 `ChatProviderAdapter` 前端适配层。
- 统一状态分层：
  - UI 状态（面板、主题、折叠态）
  - 会话状态（chat list / active chat）
  - 消息状态（streaming / error / retry）
- 统一本地存储协议（版本号 + 数据迁移函数）。

完成标准：

- 不依赖服务端会话 API 也可完整聊天与管理会话。
- 刷新页面后会话与设置可恢复。

### Phase 2：核心对话体验对齐主流产品

目标：把聊天体验做扎实。

- 交互增强：停止生成、重新生成、复制消息、编辑后重发。
- 消息能力：Markdown、代码块、表格、长文本折叠、错误分级展示。
- 输入能力：快捷键、模板提示词、历史输入回溯。

完成标准：

- 覆盖常见聊天工作流：提问、追问、重试、修订、复制。

### Phase 3：会话系统进阶

目标：会话系统具备中大型项目可用性。

- 会话分组（Today / 7 Days / 30 Days）。
- 会话批量操作（批量删除、批量置顶、批量导出）。
- 全局搜索（标题 + 消息内容关键字）。

完成标准：

- 100+ 会话场景下仍可快速定位与操作。

### Phase 4：模型与配置中心

目标：支持多模型与可配置运行时。

- 模型配置中心：Provider、Model、温度、最大 tokens。
- 多 Provider 适配：DeepSeek / OpenAI-compatible（统一接口）。
- 请求生命周期可观测：首 token 时间、总耗时、失败原因。

完成标准：

- 同一套 UI 无缝切换多个模型配置。

### Phase 5：工程质量与发布

目标：可持续迭代。

- 测试：关键状态流单测 + 关键交互 E2E。
- 性能：首屏、长会话渲染、消息列表虚拟化（必要时）。
- 文档：二开指南、配置说明、故障排查。

完成标准：

- 具备稳定发布节奏与回归保障。

## 近期执行清单（建议 2 周）

### Week 1

- 抽离前端 `ChatProviderAdapter`。
- 本地会话数据结构版本化（含 migration）。
- 让聊天页不再依赖 `app/api/get-chats` / `app/api/create-chat`。

### Week 2

- 上线“重试/重新生成/编辑后重发”三项核心交互。
- 增加会话分组与消息内搜索。
- 补齐 README 的配置与排障章节。

## 技术栈（建议保留）

- Next.js 16（前端壳层）
- React + TypeScript
- Tailwind CSS
- React Query（异步状态）
- Vercel AI SDK（可继续沿用 UI/流式能力）

## 本地运行

```bash
pnpm install
pnpm dev
pnpm build
pnpm start
```

默认地址：`http://localhost:3000`

## 许可证

MIT
